<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<h:head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Carrito de Compras - Deportes 360</title>
    <link rel="icon" type="image/x-icon" href="#{resource['images/Carrito.png']}"/>
    <h:outputStylesheet library="css" name="carrito.css"/>
</h:head>

<h:body>

    <!-- Verificaci칩n de sesi칩n CORREGIDA -->
    <f:event type="preRenderView" listener="#{loginBean.verifSesionUsuario}" />

    <header class="header">
        <div class="container menu">
            <a href="usuario.xhtml" class="logo">Deportes 360</a>

            <nav class="navbar">
                <ul>
                    <h:link outcome="/usuario" value="volver" />
                    <li><a href="catalogo.xhtml">Productos</a></li>
                    <li><a href="contacto1.xhtml">Contacto</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <main class="container">

        <h1>游 Tu Carrito de Compras</h1>

        <h:form>

            <ui:repeat value="#{carritoBean.productos}" var="p" varStatus="i">

                <div class="item-carrito">

                    <div class="item-left">

                        <h:graphicImage library="images" name="#{p.imagen}" width="90" height="90" style="border-radius:10px;"/>

                        <div class="item-info">
                            <h4>#{p.nombre}</h4>
                            <p><strong>Precio:</strong> $#{p.precio}</p>
                            <p><strong>Talla:</strong> #{p.talla}</p>
                        </div>

                    </div>

                    <h:commandButton 
                        value="Eliminar" 
                        styleClass="btn-eliminar"
                        action="#{carritoBean.eliminar(i.index)}"/>

                </div>

            </ui:repeat>

            <h:panelGroup rendered="#{empty carritoBean.productos}">
                <p class="vacio">Tu carrito est치 vac칤o.</p>
            </h:panelGroup>

            <div class="resumen-carrito">

                <h3>Total: 
                    <span id="total">
                        $#{carritoBean.total}
                    </span>
                </h3>

                <div class="acciones">
                    <a href="catalogo.xhtml" class="btn-finalizar">Seguir comprando</a>
                    <a href="/errors/PaginaNo.xhtml" class="btn-finalizar">쯊ienes un cup칩n?</a>
                    <a href="usuario.xhtml" class="btn-finalizar">Volver</a>
                    <a href="formulario.xhtml" class="btn-finalizar">Finalizar compra</a>

                    <h:commandButton 
                        value="Vaciar carrito" 
                        action="#{carritoBean.vaciar}"
                        styleClass="btn-danger"/>
                </div>

            </div>

        </h:form>

    </main>

</h:body>
</html>
